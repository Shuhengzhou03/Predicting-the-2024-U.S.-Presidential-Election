"0","#| echo: false"
"0","#| warning: false"
"0","#| message: false"
"0","#| results: ""hide"""
"0","#| label: fig-Key-State"
"0",""
"0","state_support <- combined_data |>"
"0","  group_by(state, candidate) |>"
"0","  summarize(avg_support = mean(fitted_pct), .groups = ""drop"")"
"0",""
"0","# Retain data for key states only"
"0","key_states <- c(""Florida"", ""Pennsylvania"", ""Michigan"", ""Wisconsin"", ""Arizona"", "
"0","                ""Georgia"", ""Texas"", ""California"", ""New York"", ""North Carolina"")"
"0",""
"0","state_support_filtered <- state_support |>"
"0","  filter(state %in% key_states)"
"0",""
"0","# Plot predicted support by key states only"
"0","fig2 <- ggplot(state_support_filtered, aes(x = reorder(state, avg_support), y = avg_support, fill = candidate)) +"
"0","  geom_bar(stat = ""identity"", position = ""dodge"") +"
"0","  theme_minimal() +"
"0","  labs("
"0","    y = ""Average Predicted Support Percentage"","
"0","    x = ""State"","
"0","    title = ""Predicted Support in Key States for Harris & Trump"""
"0","  ) +"
"0","  scale_fill_manual(values = c(""Kamala Harris"" = ""#66CCCC"", ""Donald Trump"" = ""#FF9999"")) +"
"0","  coord_flip() +"
"0","  theme("
"0","    axis.text.y = element_text(size = 8)"
"0","  )"
"0",""
"0","# Print the plot"
"0","print(fig2)"
